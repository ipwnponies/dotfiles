" Insert mapping: {
    inoremap jj <esc>
" }

" Normal mapping: {
    " Insert mode and go to end of line
    nnoremap gi gi<c-e>
    " Fatsecret go to insert mode
    nnoremap gI :fatsecret<cr>2gi

    " Swap page back/forth to lower case as it's more often used
    nnoremap h H
    nnoremap H h
    nnoremap l L
    nnoremap L l

    " Move page up/down to convenient keys
    nnoremap f <c-f>
    nnoremap b <c-b>

    " Remap hint as f is used for moving pages
    nnoremap v f

    " Switch to previous tab
    nnoremap e <c-^>
" }

" Command-line mapping: {
    cnoremap <C-p> <up>
    cnoremap <C-n> <down>
" }

" Always show status bar so it doesn't jump around
set statuslinevisibility=visible

" Stay in normal mode when visiting page
set focuscontent

" Only show tabs and navigation bar/addons
set gui=addons,nobookmarks,nomenu,navigation,tabs

" Show links like normal Firefox, don't pollute vimperator
set showstatuslinks=3

" Complete first match and show other options
set wildmode=list:full

" Search complete order: {
    " Clear
    set complete=
    " Search engine and keyword search is disabled because it slows down custom search keywords
    " set complete+=s
    " Location bar (bookmark and history)
    set complete+=l
    " Search suggestions
    set complete+=S
" }

" Command to go to reading mode
command -nargs=0 reader :execute "open about:reader?url=" + content.location.href
command -nargs=0 fatsecret :js var doc=window.content.window.document; (doc.getElementById('searchBfastExp') || doc.getElementById('searchLunchExp') || doc.getElementById('searchDinnerExp') || doc.getElementById('searchOtherExp')).click()

" Google docs doesn't play well, takes its ball home
ignorekeys add https://docs\.google\.com/(document|presentation)/d/.*
ignorekeys add inbox\\.google\\.com     -except g,t,e,<C-^>,:,<C-b>,b,<C-f>,f,v,d,r
ignorekeys add mail\\.google\\.com      -except g,t,e,<C-^>,:,<C-b>,b,<C-f>,f,v,d,r

" Firefox 51 broke Vimperator 3.15.0, workaround until 3.16.0 is released
" https://addons.mozilla.org/en-US/firefox/addon/vimperator/
" This restores partial functionality to a subset of tab-related functions
" : {
    " Open tab
    nnoremap t :customopen!<space>
    nnoremap o :customopen<space>
    command! customopen -bang -nargs=+ -description "Open new tab using js eval" :js liberator.open("<args>", "<bang>" ? liberator.NEW_TAB : liberator.CURRENT_TAB)

    " Close tab
    nnoremap d :js config.tabbrowser.removeTab(config.tabbrowser.mCurrentTab)<cr>

    " Undo tab close
    nnoremap u :js window.undoCloseTab()<cr>

    " Reload tab
    nnoremap r :js config.tabbrowser.reloadTab(config.tabbrowser.mCurrentTab)<cr>
" }
