# Allow many git operations, to facilitate more agent autonomy
prefix_rule(
    pattern=["git", "status"],
    decision="allow",
    justification="Checking the status of a git repository is safe",
    match=[
        'git status',
        'git status --short',
    ]
)
prefix_rule(
    pattern=["git", "rev-parse"],
    decision="allow",
    jusfitication="Getting git repository information is safe",
    match=[
        'git rev-parse --is-inside-work-tree',
        'git rev-parse --show-toplevel',
        'git rev-parse HEAD',
        'git rev-parse --abbrev-ref HEAD'
    ]
)
